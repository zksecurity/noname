<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Source of the Rust file `/home/runner/.cargo/registry/src/github.com-1ecc6299db9ec823/miette-5.0.0/src/lib.rs`."><meta name="keywords" content="rust, rustlang, rust-lang"><title>lib.rs - source</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../../normalize.css"><link rel="stylesheet" type="text/css" href="../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../../dark.css" disabled><link rel="stylesheet" type="text/css" href="../../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../../storage.js"></script><script defer src="../../source-script.js"></script><script defer src="../../source-files.js"></script><script defer src="../../main.js"></script><noscript><link rel="stylesheet" href="../../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../../favicon.svg"></head><body class="rustdoc source"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../../miette/index.html"><div class="logo-container"><img class="rust-logo" src="../../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"></h2>
    </nav>
    <nav class="sidebar"><a class="sidebar-logo" href="../../miette/index.html"><div class="logo-container"><img class="rust-logo" src="../../rust-logo.svg" alt="logo"></div>
        </a></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../../miette/index.html"><img class="rust-logo" src="../../rust-logo.svg" alt="logo"></a><nav class="sub"><form class="search-form"><div class="search-container"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><button type="button" id="help-button" title="help">?</button><div id="settings-menu" tabindex="-1">
                                <a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../wheel.svg"></a></div>
                        </div></form></nav></div><section id="main-content" class="content"><div class="example-wrap"><pre class="line-numbers"><span id="1">1</span>
<span id="2">2</span>
<span id="3">3</span>
<span id="4">4</span>
<span id="5">5</span>
<span id="6">6</span>
<span id="7">7</span>
<span id="8">8</span>
<span id="9">9</span>
<span id="10">10</span>
<span id="11">11</span>
<span id="12">12</span>
<span id="13">13</span>
<span id="14">14</span>
<span id="15">15</span>
<span id="16">16</span>
<span id="17">17</span>
<span id="18">18</span>
<span id="19">19</span>
<span id="20">20</span>
<span id="21">21</span>
<span id="22">22</span>
<span id="23">23</span>
<span id="24">24</span>
<span id="25">25</span>
<span id="26">26</span>
<span id="27">27</span>
<span id="28">28</span>
<span id="29">29</span>
<span id="30">30</span>
<span id="31">31</span>
<span id="32">32</span>
<span id="33">33</span>
<span id="34">34</span>
<span id="35">35</span>
<span id="36">36</span>
<span id="37">37</span>
<span id="38">38</span>
<span id="39">39</span>
<span id="40">40</span>
<span id="41">41</span>
<span id="42">42</span>
<span id="43">43</span>
<span id="44">44</span>
<span id="45">45</span>
<span id="46">46</span>
<span id="47">47</span>
<span id="48">48</span>
<span id="49">49</span>
<span id="50">50</span>
<span id="51">51</span>
<span id="52">52</span>
<span id="53">53</span>
<span id="54">54</span>
<span id="55">55</span>
<span id="56">56</span>
<span id="57">57</span>
<span id="58">58</span>
<span id="59">59</span>
<span id="60">60</span>
<span id="61">61</span>
<span id="62">62</span>
<span id="63">63</span>
<span id="64">64</span>
<span id="65">65</span>
<span id="66">66</span>
<span id="67">67</span>
<span id="68">68</span>
<span id="69">69</span>
<span id="70">70</span>
<span id="71">71</span>
<span id="72">72</span>
<span id="73">73</span>
<span id="74">74</span>
<span id="75">75</span>
<span id="76">76</span>
<span id="77">77</span>
<span id="78">78</span>
<span id="79">79</span>
<span id="80">80</span>
<span id="81">81</span>
<span id="82">82</span>
<span id="83">83</span>
<span id="84">84</span>
<span id="85">85</span>
<span id="86">86</span>
<span id="87">87</span>
<span id="88">88</span>
<span id="89">89</span>
<span id="90">90</span>
<span id="91">91</span>
<span id="92">92</span>
<span id="93">93</span>
<span id="94">94</span>
<span id="95">95</span>
<span id="96">96</span>
<span id="97">97</span>
<span id="98">98</span>
<span id="99">99</span>
<span id="100">100</span>
<span id="101">101</span>
<span id="102">102</span>
<span id="103">103</span>
<span id="104">104</span>
<span id="105">105</span>
<span id="106">106</span>
<span id="107">107</span>
<span id="108">108</span>
<span id="109">109</span>
<span id="110">110</span>
<span id="111">111</span>
<span id="112">112</span>
<span id="113">113</span>
<span id="114">114</span>
<span id="115">115</span>
<span id="116">116</span>
<span id="117">117</span>
<span id="118">118</span>
<span id="119">119</span>
<span id="120">120</span>
<span id="121">121</span>
<span id="122">122</span>
<span id="123">123</span>
<span id="124">124</span>
<span id="125">125</span>
<span id="126">126</span>
<span id="127">127</span>
<span id="128">128</span>
<span id="129">129</span>
<span id="130">130</span>
<span id="131">131</span>
<span id="132">132</span>
<span id="133">133</span>
<span id="134">134</span>
<span id="135">135</span>
<span id="136">136</span>
<span id="137">137</span>
<span id="138">138</span>
<span id="139">139</span>
<span id="140">140</span>
<span id="141">141</span>
<span id="142">142</span>
<span id="143">143</span>
<span id="144">144</span>
<span id="145">145</span>
<span id="146">146</span>
<span id="147">147</span>
<span id="148">148</span>
<span id="149">149</span>
<span id="150">150</span>
<span id="151">151</span>
<span id="152">152</span>
<span id="153">153</span>
<span id="154">154</span>
<span id="155">155</span>
<span id="156">156</span>
<span id="157">157</span>
<span id="158">158</span>
<span id="159">159</span>
<span id="160">160</span>
<span id="161">161</span>
<span id="162">162</span>
<span id="163">163</span>
<span id="164">164</span>
<span id="165">165</span>
<span id="166">166</span>
<span id="167">167</span>
<span id="168">168</span>
<span id="169">169</span>
<span id="170">170</span>
<span id="171">171</span>
<span id="172">172</span>
<span id="173">173</span>
<span id="174">174</span>
<span id="175">175</span>
<span id="176">176</span>
<span id="177">177</span>
<span id="178">178</span>
<span id="179">179</span>
<span id="180">180</span>
<span id="181">181</span>
<span id="182">182</span>
<span id="183">183</span>
<span id="184">184</span>
<span id="185">185</span>
<span id="186">186</span>
<span id="187">187</span>
<span id="188">188</span>
<span id="189">189</span>
<span id="190">190</span>
<span id="191">191</span>
<span id="192">192</span>
<span id="193">193</span>
<span id="194">194</span>
<span id="195">195</span>
<span id="196">196</span>
<span id="197">197</span>
<span id="198">198</span>
<span id="199">199</span>
<span id="200">200</span>
<span id="201">201</span>
<span id="202">202</span>
<span id="203">203</span>
<span id="204">204</span>
<span id="205">205</span>
<span id="206">206</span>
<span id="207">207</span>
<span id="208">208</span>
<span id="209">209</span>
<span id="210">210</span>
<span id="211">211</span>
<span id="212">212</span>
<span id="213">213</span>
<span id="214">214</span>
<span id="215">215</span>
<span id="216">216</span>
<span id="217">217</span>
<span id="218">218</span>
<span id="219">219</span>
<span id="220">220</span>
<span id="221">221</span>
<span id="222">222</span>
<span id="223">223</span>
<span id="224">224</span>
<span id="225">225</span>
<span id="226">226</span>
<span id="227">227</span>
<span id="228">228</span>
<span id="229">229</span>
<span id="230">230</span>
<span id="231">231</span>
<span id="232">232</span>
<span id="233">233</span>
<span id="234">234</span>
<span id="235">235</span>
<span id="236">236</span>
<span id="237">237</span>
<span id="238">238</span>
<span id="239">239</span>
<span id="240">240</span>
<span id="241">241</span>
<span id="242">242</span>
<span id="243">243</span>
<span id="244">244</span>
<span id="245">245</span>
<span id="246">246</span>
<span id="247">247</span>
<span id="248">248</span>
<span id="249">249</span>
<span id="250">250</span>
<span id="251">251</span>
<span id="252">252</span>
<span id="253">253</span>
<span id="254">254</span>
<span id="255">255</span>
<span id="256">256</span>
<span id="257">257</span>
<span id="258">258</span>
<span id="259">259</span>
<span id="260">260</span>
<span id="261">261</span>
<span id="262">262</span>
<span id="263">263</span>
<span id="264">264</span>
<span id="265">265</span>
<span id="266">266</span>
<span id="267">267</span>
<span id="268">268</span>
<span id="269">269</span>
<span id="270">270</span>
<span id="271">271</span>
<span id="272">272</span>
<span id="273">273</span>
<span id="274">274</span>
<span id="275">275</span>
<span id="276">276</span>
<span id="277">277</span>
<span id="278">278</span>
<span id="279">279</span>
<span id="280">280</span>
<span id="281">281</span>
<span id="282">282</span>
<span id="283">283</span>
<span id="284">284</span>
<span id="285">285</span>
<span id="286">286</span>
<span id="287">287</span>
<span id="288">288</span>
<span id="289">289</span>
<span id="290">290</span>
<span id="291">291</span>
<span id="292">292</span>
<span id="293">293</span>
<span id="294">294</span>
<span id="295">295</span>
<span id="296">296</span>
<span id="297">297</span>
<span id="298">298</span>
<span id="299">299</span>
<span id="300">300</span>
<span id="301">301</span>
<span id="302">302</span>
<span id="303">303</span>
<span id="304">304</span>
<span id="305">305</span>
<span id="306">306</span>
<span id="307">307</span>
<span id="308">308</span>
<span id="309">309</span>
<span id="310">310</span>
<span id="311">311</span>
<span id="312">312</span>
<span id="313">313</span>
<span id="314">314</span>
<span id="315">315</span>
<span id="316">316</span>
<span id="317">317</span>
<span id="318">318</span>
<span id="319">319</span>
<span id="320">320</span>
<span id="321">321</span>
<span id="322">322</span>
<span id="323">323</span>
<span id="324">324</span>
<span id="325">325</span>
<span id="326">326</span>
<span id="327">327</span>
<span id="328">328</span>
<span id="329">329</span>
<span id="330">330</span>
<span id="331">331</span>
<span id="332">332</span>
<span id="333">333</span>
<span id="334">334</span>
<span id="335">335</span>
<span id="336">336</span>
<span id="337">337</span>
<span id="338">338</span>
<span id="339">339</span>
<span id="340">340</span>
<span id="341">341</span>
<span id="342">342</span>
<span id="343">343</span>
<span id="344">344</span>
<span id="345">345</span>
<span id="346">346</span>
<span id="347">347</span>
<span id="348">348</span>
<span id="349">349</span>
<span id="350">350</span>
<span id="351">351</span>
<span id="352">352</span>
<span id="353">353</span>
<span id="354">354</span>
<span id="355">355</span>
<span id="356">356</span>
<span id="357">357</span>
<span id="358">358</span>
<span id="359">359</span>
<span id="360">360</span>
<span id="361">361</span>
<span id="362">362</span>
<span id="363">363</span>
<span id="364">364</span>
<span id="365">365</span>
<span id="366">366</span>
<span id="367">367</span>
<span id="368">368</span>
<span id="369">369</span>
<span id="370">370</span>
<span id="371">371</span>
<span id="372">372</span>
<span id="373">373</span>
<span id="374">374</span>
<span id="375">375</span>
<span id="376">376</span>
<span id="377">377</span>
<span id="378">378</span>
<span id="379">379</span>
<span id="380">380</span>
<span id="381">381</span>
<span id="382">382</span>
<span id="383">383</span>
<span id="384">384</span>
<span id="385">385</span>
<span id="386">386</span>
<span id="387">387</span>
<span id="388">388</span>
<span id="389">389</span>
<span id="390">390</span>
<span id="391">391</span>
<span id="392">392</span>
<span id="393">393</span>
<span id="394">394</span>
<span id="395">395</span>
<span id="396">396</span>
<span id="397">397</span>
<span id="398">398</span>
<span id="399">399</span>
<span id="400">400</span>
<span id="401">401</span>
<span id="402">402</span>
<span id="403">403</span>
<span id="404">404</span>
<span id="405">405</span>
<span id="406">406</span>
<span id="407">407</span>
<span id="408">408</span>
<span id="409">409</span>
<span id="410">410</span>
<span id="411">411</span>
<span id="412">412</span>
<span id="413">413</span>
<span id="414">414</span>
<span id="415">415</span>
<span id="416">416</span>
<span id="417">417</span>
<span id="418">418</span>
<span id="419">419</span>
<span id="420">420</span>
<span id="421">421</span>
<span id="422">422</span>
<span id="423">423</span>
<span id="424">424</span>
<span id="425">425</span>
<span id="426">426</span>
<span id="427">427</span>
<span id="428">428</span>
<span id="429">429</span>
<span id="430">430</span>
<span id="431">431</span>
<span id="432">432</span>
<span id="433">433</span>
<span id="434">434</span>
<span id="435">435</span>
<span id="436">436</span>
<span id="437">437</span>
<span id="438">438</span>
<span id="439">439</span>
<span id="440">440</span>
<span id="441">441</span>
<span id="442">442</span>
<span id="443">443</span>
<span id="444">444</span>
<span id="445">445</span>
<span id="446">446</span>
<span id="447">447</span>
<span id="448">448</span>
<span id="449">449</span>
<span id="450">450</span>
<span id="451">451</span>
<span id="452">452</span>
<span id="453">453</span>
<span id="454">454</span>
<span id="455">455</span>
<span id="456">456</span>
<span id="457">457</span>
<span id="458">458</span>
<span id="459">459</span>
<span id="460">460</span>
<span id="461">461</span>
<span id="462">462</span>
<span id="463">463</span>
<span id="464">464</span>
<span id="465">465</span>
<span id="466">466</span>
<span id="467">467</span>
<span id="468">468</span>
<span id="469">469</span>
<span id="470">470</span>
<span id="471">471</span>
<span id="472">472</span>
<span id="473">473</span>
<span id="474">474</span>
<span id="475">475</span>
<span id="476">476</span>
<span id="477">477</span>
<span id="478">478</span>
<span id="479">479</span>
<span id="480">480</span>
<span id="481">481</span>
<span id="482">482</span>
<span id="483">483</span>
<span id="484">484</span>
<span id="485">485</span>
<span id="486">486</span>
<span id="487">487</span>
<span id="488">488</span>
<span id="489">489</span>
<span id="490">490</span>
<span id="491">491</span>
<span id="492">492</span>
<span id="493">493</span>
<span id="494">494</span>
<span id="495">495</span>
<span id="496">496</span>
<span id="497">497</span>
<span id="498">498</span>
<span id="499">499</span>
<span id="500">500</span>
<span id="501">501</span>
<span id="502">502</span>
<span id="503">503</span>
<span id="504">504</span>
<span id="505">505</span>
<span id="506">506</span>
<span id="507">507</span>
<span id="508">508</span>
<span id="509">509</span>
<span id="510">510</span>
<span id="511">511</span>
<span id="512">512</span>
<span id="513">513</span>
<span id="514">514</span>
<span id="515">515</span>
<span id="516">516</span>
<span id="517">517</span>
<span id="518">518</span>
<span id="519">519</span>
<span id="520">520</span>
<span id="521">521</span>
<span id="522">522</span>
<span id="523">523</span>
<span id="524">524</span>
<span id="525">525</span>
<span id="526">526</span>
<span id="527">527</span>
<span id="528">528</span>
<span id="529">529</span>
<span id="530">530</span>
<span id="531">531</span>
<span id="532">532</span>
<span id="533">533</span>
<span id="534">534</span>
<span id="535">535</span>
<span id="536">536</span>
<span id="537">537</span>
<span id="538">538</span>
<span id="539">539</span>
<span id="540">540</span>
<span id="541">541</span>
<span id="542">542</span>
<span id="543">543</span>
<span id="544">544</span>
<span id="545">545</span>
<span id="546">546</span>
<span id="547">547</span>
<span id="548">548</span>
<span id="549">549</span>
<span id="550">550</span>
<span id="551">551</span>
<span id="552">552</span>
<span id="553">553</span>
<span id="554">554</span>
<span id="555">555</span>
<span id="556">556</span>
<span id="557">557</span>
<span id="558">558</span>
<span id="559">559</span>
<span id="560">560</span>
<span id="561">561</span>
<span id="562">562</span>
<span id="563">563</span>
<span id="564">564</span>
<span id="565">565</span>
<span id="566">566</span>
<span id="567">567</span>
<span id="568">568</span>
<span id="569">569</span>
<span id="570">570</span>
<span id="571">571</span>
<span id="572">572</span>
<span id="573">573</span>
<span id="574">574</span>
<span id="575">575</span>
<span id="576">576</span>
<span id="577">577</span>
<span id="578">578</span>
<span id="579">579</span>
<span id="580">580</span>
<span id="581">581</span>
<span id="582">582</span>
<span id="583">583</span>
<span id="584">584</span>
<span id="585">585</span>
<span id="586">586</span>
<span id="587">587</span>
<span id="588">588</span>
<span id="589">589</span>
<span id="590">590</span>
<span id="591">591</span>
<span id="592">592</span>
<span id="593">593</span>
<span id="594">594</span>
<span id="595">595</span>
<span id="596">596</span>
<span id="597">597</span>
<span id="598">598</span>
<span id="599">599</span>
<span id="600">600</span>
<span id="601">601</span>
<span id="602">602</span>
<span id="603">603</span>
<span id="604">604</span>
<span id="605">605</span>
<span id="606">606</span>
<span id="607">607</span>
<span id="608">608</span>
<span id="609">609</span>
<span id="610">610</span>
<span id="611">611</span>
<span id="612">612</span>
<span id="613">613</span>
<span id="614">614</span>
<span id="615">615</span>
<span id="616">616</span>
<span id="617">617</span>
<span id="618">618</span>
<span id="619">619</span>
<span id="620">620</span>
<span id="621">621</span>
<span id="622">622</span>
<span id="623">623</span>
<span id="624">624</span>
<span id="625">625</span>
<span id="626">626</span>
<span id="627">627</span>
<span id="628">628</span>
<span id="629">629</span>
<span id="630">630</span>
<span id="631">631</span>
<span id="632">632</span>
<span id="633">633</span>
</pre><pre class="rust"><code><span class="attribute">#![<span class="ident">deny</span>(<span class="ident">missing_docs</span>, <span class="ident">missing_debug_implementations</span>, <span class="ident">nonstandard_style</span>)]</span>
<span class="attribute">#![<span class="ident">warn</span>(<span class="ident">unreachable_pub</span>, <span class="ident">rust_2018_idioms</span>)]</span>
<span class="doccomment">//! You run miette? You run her code like the software? Oh. Oh! Error code for</span>
<span class="doccomment">//! coder! Error code for One Thousand Lines!</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! ## About</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! `miette` is a diagnostic library for Rust. It includes a series of</span>
<span class="doccomment">//! traits/protocols that allow you to hook into its error reporting facilities,</span>
<span class="doccomment">//! and even write your own error reports! It lets you define error types that</span>
<span class="doccomment">//! can print out like this (or in any format you like!):</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! &lt;img src=&quot;https://raw.githubusercontent.com/zkat/miette/main/images/serde_json.png&quot; alt=&quot;Hi! miette also includes a screen-reader-oriented diagnostic printer that&#39;s enabled in various situations, such as when you use NO_COLOR or CLICOLOR settings, or on CI. This behavior is also fully configurable and customizable. For example, this is what this particular diagnostic will look like when the narrated printer is enabled:</span>
<span class="doccomment">//! \</span>
<span class="doccomment">//! Error: Received some bad JSON from the source. Unable to parse.</span>
<span class="doccomment">//!     Caused by: missing field `foo` at line 1 column 1700</span>
<span class="doccomment">//! \</span>
<span class="doccomment">//! Begin snippet for https://api.nuget.org/v3/registration5-gz-semver2/json.net/index.json starting</span>
<span class="doccomment">//! at line 1, column 1659</span>
<span class="doccomment">//! \</span>
<span class="doccomment">//! snippet line 1: gs&amp;quot;:[&amp;quot;json&amp;quot;],&amp;quot;title&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;version&amp;quot;:&amp;quot;1.0.0&amp;quot;},&amp;quot;packageContent&amp;quot;:&amp;quot;https://api.nuget.o</span>
<span class="doccomment">//!     highlight starting at line 1, column 1699: last parsing location</span>
<span class="doccomment">//! \</span>
<span class="doccomment">//! diagnostic help: This is a bug. It might be in ruget, or it might be in the</span>
<span class="doccomment">//! source you&#39;re using, but it&#39;s definitely a bug and should be reported.</span>
<span class="doccomment">//! diagnostic error code: ruget::api::bad_json</span>
<span class="doccomment">//! &quot; /&gt;</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! &gt; **NOTE: You must enable the `&quot;fancy&quot;` crate feature to get fancy report</span>
<span class="doccomment">//! output like in the screenshots above.** You should only do this in your</span>
<span class="doccomment">//! toplevel crate, as the fancy feature pulls in a number of dependencies that</span>
<span class="doccomment">//! libraries and such might not want.</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! ## Table of Contents &lt;!-- omit in toc --&gt;</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! - [About](#about)</span>
<span class="doccomment">//! - [Features](#features)</span>
<span class="doccomment">//! - [Installing](#installing)</span>
<span class="doccomment">//! - [Example](#example)</span>
<span class="doccomment">//! - [Using](#using)</span>
<span class="doccomment">//!   - [... in libraries](#-in-libraries)</span>
<span class="doccomment">//!   - [... in application code](#-in-application-code)</span>
<span class="doccomment">//!   - [... in `main()`](#-in-main)</span>
<span class="doccomment">//!   - [... diagnostic code URLs](#-diagnostic-code-urls)</span>
<span class="doccomment">//!   - [... snippets](#-snippets)</span>
<span class="doccomment">//!   - [... multiple related errors](#-multiple-related-errors)</span>
<span class="doccomment">//!   - [... delayed source code](#-delayed-source-code)</span>
<span class="doccomment">//!   - [... handler options](#-handler-options)</span>
<span class="doccomment">//! - [Acknowledgements](#acknowledgements)</span>
<span class="doccomment">//! - [License](#license)</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! ## Features</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! - Generic [`Diagnostic`] protocol, compatible (and dependent on)</span>
<span class="doccomment">//!   [`std::error::Error`].</span>
<span class="doccomment">//! - Unique error codes on every [`Diagnostic`].</span>
<span class="doccomment">//! - Custom links to get more details on error codes.</span>
<span class="doccomment">//! - Super handy derive macro for defining diagnostic metadata.</span>
<span class="doccomment">//! - Replacements for [`anyhow`](https://docs.rs/anyhow)/[`eyre`](https://docs.rs/eyre)</span>
<span class="doccomment">//!   types [`Result`], [`Report`] and the [`miette!`] macro for the</span>
<span class="doccomment">//!   `anyhow!`/`eyre!` macros.</span>
<span class="doccomment">//! - Generic support for arbitrary [`SourceCode`]s for snippet data, with</span>
<span class="doccomment">//!   default support for `String`s included.</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! The `miette` crate also comes bundled with a default [`ReportHandler`] with</span>
<span class="doccomment">//! the following features:</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! - Fancy graphical [diagnostic output](#about), using ANSI/Unicode text</span>
<span class="doccomment">//! - single- and multi-line highlighting support</span>
<span class="doccomment">//! - Screen reader/braille support, gated on [`NO_COLOR`](http://no-color.org/),</span>
<span class="doccomment">//!   and other heuristics.</span>
<span class="doccomment">//! - Fully customizable graphical theming (or overriding the printers</span>
<span class="doccomment">//!   entirely).</span>
<span class="doccomment">//! - Cause chain printing</span>
<span class="doccomment">//! - Turns diagnostic codes into links in [supported terminals](https://gist.github.com/egmontkob/eb114294efbcd5adb1944c9f3cb5feda).</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! ## Installing</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! Using [`cargo-edit`](https://crates.io/crates/cargo-edit):</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! ```sh</span>
<span class="doccomment">//! $ cargo add miette</span>
<span class="doccomment">//! ```</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! If you want to use the fancy printer in all these screenshots:</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! ```sh</span>
<span class="doccomment">//! $ cargo add miette --features fancy</span>
<span class="doccomment">//! ```</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! ## Example</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! ```rust</span>
<span class="doccomment">//! /*</span>
<span class="doccomment">//! You can derive a `Diagnostic` from any `std::error::Error` type.</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! `thiserror` is a great way to define them, and plays nicely with `miette`!</span>
<span class="doccomment">//! */</span>
<span class="doccomment">//! use miette::{Diagnostic, SourceSpan};</span>
<span class="doccomment">//! use thiserror::Error;</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! #[derive(Error, Debug, Diagnostic)]</span>
<span class="doccomment">//! #[error(&quot;oops!&quot;)]</span>
<span class="doccomment">//! #[diagnostic(</span>
<span class="doccomment">//!     code(oops::my::bad),</span>
<span class="doccomment">//!     url(docsrs),</span>
<span class="doccomment">//!     help(&quot;try doing it better next time?&quot;)</span>
<span class="doccomment">//! )]</span>
<span class="doccomment">//! struct MyBad {</span>
<span class="doccomment">//!     // The Source that we&#39;re gonna be printing snippets out of.</span>
<span class="doccomment">//!     // This can be a String if you don&#39;t have or care about file names.</span>
<span class="doccomment">//!     #[source_code]</span>
<span class="doccomment">//!     src: NamedSource,</span>
<span class="doccomment">//!     // Snippets and highlights can be included in the diagnostic!</span>
<span class="doccomment">//!     #[label(&quot;This bit here&quot;)]</span>
<span class="doccomment">//!     bad_bit: SourceSpan,</span>
<span class="doccomment">//! }</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! /*</span>
<span class="doccomment">//! Now let&#39;s define a function!</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! Use this `Result` type (or its expanded version) as the return type</span>
<span class="doccomment">//! throughout your app (but NOT your libraries! Those should always return</span>
<span class="doccomment">//! concrete types!).</span>
<span class="doccomment">//! */</span>
<span class="doccomment">//! use miette::{NamedSource, Result};</span>
<span class="doccomment">//! fn this_fails() -&gt; Result&lt;()&gt; {</span>
<span class="doccomment">//!     // You can use plain strings as a `Source`, or anything that implements</span>
<span class="doccomment">//!     // the one-method `Source` trait.</span>
<span class="doccomment">//!     let src = &quot;source\n  text\n    here&quot;.to_string();</span>
<span class="doccomment">//!     let len = src.len();</span>
<span class="doccomment">//!</span>
<span class="doccomment">//!     Err(MyBad {</span>
<span class="doccomment">//!         src: NamedSource::new(&quot;bad_file.rs&quot;, src),</span>
<span class="doccomment">//!         bad_bit: (9, 4).into(),</span>
<span class="doccomment">//!     })?;</span>
<span class="doccomment">//!</span>
<span class="doccomment">//!     Ok(())</span>
<span class="doccomment">//! }</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! /*</span>
<span class="doccomment">//! Now to get everything printed nicely, just return a `Result&lt;()&gt;`</span>
<span class="doccomment">//! and you&#39;re all set!</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! Note: You can swap out the default reporter for a custom one using</span>
<span class="doccomment">//! `miette::set_hook()`</span>
<span class="doccomment">//! */</span>
<span class="doccomment">//! fn pretend_this_is_main() -&gt; Result&lt;()&gt; {</span>
<span class="doccomment">//!     // kaboom~</span>
<span class="doccomment">//!     this_fails()?;</span>
<span class="doccomment">//!</span>
<span class="doccomment">//!     Ok(())</span>
<span class="doccomment">//! }</span>
<span class="doccomment">//! ```</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! And this is the output you&#39;ll get if you run this program:</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! &lt;img src=&quot;https://raw.githubusercontent.com/zkat/miette/main/images/single-line-example.png&quot; alt=&quot;</span>
<span class="doccomment">//! Narratable printout:</span>
<span class="doccomment">//! \</span>
<span class="doccomment">//! Error: Types mismatched for operation.</span>
<span class="doccomment">//!     Diagnostic severity: error</span>
<span class="doccomment">//! Begin snippet starting at line 1, column 1</span>
<span class="doccomment">//! \</span>
<span class="doccomment">//! snippet line 1: 3 + &amp;quot;5&amp;quot;</span>
<span class="doccomment">//!     label starting at line 1, column 1: int</span>
<span class="doccomment">//!     label starting at line 1, column 1: doesn&#39;t support these values.</span>
<span class="doccomment">//!     label starting at line 1, column 1: string</span>
<span class="doccomment">//! diagnostic help: Change int or string to be the right types and try again.</span>
<span class="doccomment">//! diagnostic code: nu::parser::unsupported_operation</span>
<span class="doccomment">//! For more details, see https://docs.rs/nu-parser/0.1.0/nu-parser/enum.ParseError.html#variant.UnsupportedOperation&quot;&gt;</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! ## Using</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! ### ... in libraries</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! `miette` is _fully compatible_ with library usage. Consumers who don&#39;t know</span>
<span class="doccomment">//! about, or don&#39;t want, `miette` features can safely use its error types as</span>
<span class="doccomment">//! regular [`std::error::Error`].</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! We highly recommend using something like [`thiserror`](https://docs.rs/thiserror)</span>
<span class="doccomment">//! to define unique error types and error wrappers for your library.</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! While `miette` integrates smoothly with `thiserror`, it is _not required_.</span>
<span class="doccomment">//! If you don&#39;t want to use the [`Diagnostic`] derive macro, you can implement</span>
<span class="doccomment">//! the trait directly, just like with `std::error::Error`.</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! ```rust</span>
<span class="doccomment">//! // lib/error.rs</span>
<span class="doccomment">//! use miette::Diagnostic;</span>
<span class="doccomment">//! use thiserror::Error;</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! #[derive(Error, Diagnostic, Debug)]</span>
<span class="doccomment">//! pub enum MyLibError {</span>
<span class="doccomment">//!     #[error(transparent)]</span>
<span class="doccomment">//!     #[diagnostic(code(my_lib::io_error))]</span>
<span class="doccomment">//!     IoError(#[from] std::io::Error),</span>
<span class="doccomment">//!</span>
<span class="doccomment">//!     #[error(&quot;Oops it blew up&quot;)]</span>
<span class="doccomment">//!     #[diagnostic(code(my_lib::bad_code))]</span>
<span class="doccomment">//!     BadThingHappened,</span>
<span class="doccomment">//! }</span>
<span class="doccomment">//! ```</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! Then, return this error type from all your fallible public APIs. It&#39;s a best</span>
<span class="doccomment">//! practice to wrap any &quot;external&quot; error types in your error `enum` instead of</span>
<span class="doccomment">//! using something like [`Report`] in a library.</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! ### ... in application code</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! Application code tends to work a little differently than libraries. You</span>
<span class="doccomment">//! don&#39;t always need or care to define dedicated error wrappers for errors</span>
<span class="doccomment">//! coming from external libraries and tools.</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! For this situation, `miette` includes two tools: [`Report`] and</span>
<span class="doccomment">//! [`IntoDiagnostic`]. They work in tandem to make it easy to convert regular</span>
<span class="doccomment">//! `std::error::Error`s into [`Diagnostic`]s. Additionally, there&#39;s a</span>
<span class="doccomment">//! [`Result`] type alias that you can use to be more terse.</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! When dealing with non-`Diagnostic` types, you&#39;ll want to</span>
<span class="doccomment">//! `.into_diagnostic()` them:</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! ```rust</span>
<span class="doccomment">//! // my_app/lib/my_internal_file.rs</span>
<span class="doccomment">//! use miette::{IntoDiagnostic, Result};</span>
<span class="doccomment">//! use semver::Version;</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! pub fn some_tool() -&gt; Result&lt;Version&gt; {</span>
<span class="doccomment">//!     Ok(&quot;1.2.x&quot;.parse().into_diagnostic()?)</span>
<span class="doccomment">//! }</span>
<span class="doccomment">//! ```</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! `miette` also includes an `anyhow`/`eyre`-style `Context`/`WrapErr` traits</span>
<span class="doccomment">//! that you can import to add ad-hoc context messages to your `Diagnostic`s, as</span>
<span class="doccomment">//! well, though you&#39;ll still need to use `.into_diagnostic()` to make use of</span>
<span class="doccomment">//! it:</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! ```rust</span>
<span class="doccomment">//! // my_app/lib/my_internal_file.rs</span>
<span class="doccomment">//! use miette::{IntoDiagnostic, Result, WrapErr};</span>
<span class="doccomment">//! use semver::Version;</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! pub fn some_tool() -&gt; Result&lt;Version&gt; {</span>
<span class="doccomment">//!     Ok(&quot;1.2.x&quot;</span>
<span class="doccomment">//!         .parse()</span>
<span class="doccomment">//!         .into_diagnostic()</span>
<span class="doccomment">//!         .wrap_err(&quot;Parsing this tool&#39;s semver version failed.&quot;)?)</span>
<span class="doccomment">//! }</span>
<span class="doccomment">//! ```</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! ### ... in `main()`</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! `main()` is just like any other part of your application-internal code. Use</span>
<span class="doccomment">//! `Result` as your return value, and it will pretty-print your diagnostics</span>
<span class="doccomment">//! automatically.</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! &gt; **NOTE:** You must enable the `&quot;fancy&quot;` crate feature to get fancy report</span>
<span class="doccomment">//! output like in the screenshots here.** You should only do this in your</span>
<span class="doccomment">//! toplevel crate, as the fancy feature pulls in a number of dependencies that</span>
<span class="doccomment">//! libraries and such might not want.</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! ```rust</span>
<span class="doccomment">//! use miette::{IntoDiagnostic, Result};</span>
<span class="doccomment">//! use semver::Version;</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! fn pretend_this_is_main() -&gt; Result&lt;()&gt; {</span>
<span class="doccomment">//!     let version: Version = &quot;1.2.x&quot;.parse().into_diagnostic()?;</span>
<span class="doccomment">//!     println!(&quot;{}&quot;, version);</span>
<span class="doccomment">//!     Ok(())</span>
<span class="doccomment">//! }</span>
<span class="doccomment">//! ```</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! Please note: in order to get fancy diagnostic rendering with all the pretty</span>
<span class="doccomment">//! colors and arrows, you should install `miette` with the `fancy` feature</span>
<span class="doccomment">//! enabled:</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! ```toml</span>
<span class="doccomment">//! miette = { version = &quot;X.Y.Z&quot;, features = [&quot;fancy&quot;] }</span>
<span class="doccomment">//! ```</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! ### ... diagnostic code URLs</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! `miette` supports providing a URL for individual diagnostics. This URL will</span>
<span class="doccomment">//! be displayed as an actual link in supported terminals, like so:</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! &lt;img</span>
<span class="doccomment">//! src=&quot;https://raw.githubusercontent.com/zkat/miette/main/images/code_linking.png&quot;</span>
<span class="doccomment">//! alt=&quot; Example showing the graphical report printer for miette</span>
<span class="doccomment">//! pretty-printing an error code. The code is underlined and followed by text</span>
<span class="doccomment">//! saying to &#39;click here&#39;. A hover tooltip shows a full-fledged URL that can be</span>
<span class="doccomment">//! Ctrl+Clicked to open in a browser.</span>
<span class="doccomment">//! \</span>
<span class="doccomment">//! This feature is also available in the narratable printer. It will add a line</span>
<span class="doccomment">//! after printing the error code showing a plain URL that you can visit.</span>
<span class="doccomment">//! &quot;&gt;</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! To use this, you can add a `url()` sub-param to your `#[diagnostic]`</span>
<span class="doccomment">//! attribute:</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! ```rust</span>
<span class="doccomment">//! use miette::Diagnostic;</span>
<span class="doccomment">//! use thiserror::Error;</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! #[derive(Error, Diagnostic, Debug)]</span>
<span class="doccomment">//! #[error(&quot;kaboom&quot;)]</span>
<span class="doccomment">//! #[diagnostic(</span>
<span class="doccomment">//!     code(my_app::my_error),</span>
<span class="doccomment">//!     // You can do formatting!</span>
<span class="doccomment">//!     url(&quot;https://my_website.com/error_codes#{}&quot;, self.code().unwrap())</span>
<span class="doccomment">//! )]</span>
<span class="doccomment">//! struct MyErr;</span>
<span class="doccomment">//! ```</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! Additionally, if you&#39;re developing a library and your error type is exported</span>
<span class="doccomment">//! from your crate&#39;s top level, you can use a special `url(docsrs)` option</span>
<span class="doccomment">//! instead of manually constructing the URL. This will automatically create a</span>
<span class="doccomment">//! link to this diagnostic on `docs.rs`, so folks can just go straight to your</span>
<span class="doccomment">//! (very high quality and detailed!) documentation on this diagnostic:</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! ```rust</span>
<span class="doccomment">//! use miette::Diagnostic;</span>
<span class="doccomment">//! use thiserror::Error;</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! #[derive(Error, Diagnostic, Debug)]</span>
<span class="doccomment">//! #[diagnostic(</span>
<span class="doccomment">//!     code(my_app::my_error),</span>
<span class="doccomment">//!     // Will link users to https://docs.rs/my_crate/0.0.0/my_crate/struct.MyErr.html</span>
<span class="doccomment">//!     url(docsrs)</span>
<span class="doccomment">//! )]</span>
<span class="doccomment">//! #[error(&quot;kaboom&quot;)]</span>
<span class="doccomment">//! struct MyErr;</span>
<span class="doccomment">//! ```</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! ### ... snippets</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! Along with its general error handling and reporting features, `miette` also</span>
<span class="doccomment">//! includes facilities for adding error spans/annotations/labels to your</span>
<span class="doccomment">//! output. This can be very useful when an error is syntax-related, but you can</span>
<span class="doccomment">//! even use it to print out sections of your own source code!</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! To achieve this, `miette` defines its own lightweight [`SourceSpan`] type.</span>
<span class="doccomment">//! This is a basic byte-offset and length into an associated [`SourceCode`]</span>
<span class="doccomment">//! and, along with the latter, gives `miette` all the information it needs to</span>
<span class="doccomment">//! pretty-print some snippets! You can also use your own `Into&lt;SourceSpan&gt;`</span>
<span class="doccomment">//! types as label spans.</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! The easiest way to define errors like this is to use the</span>
<span class="doccomment">//! `derive(Diagnostic)` macro:</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! ```rust</span>
<span class="doccomment">//! use miette::{Diagnostic, SourceSpan};</span>
<span class="doccomment">//! use thiserror::Error;</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! #[derive(Diagnostic, Debug, Error)]</span>
<span class="doccomment">//! #[error(&quot;oops&quot;)]</span>
<span class="doccomment">//! #[diagnostic(code(my_lib::random_error))]</span>
<span class="doccomment">//! pub struct MyErrorType {</span>
<span class="doccomment">//!     // The `Source` that miette will use.</span>
<span class="doccomment">//!     #[source_code]</span>
<span class="doccomment">//!     src: String,</span>
<span class="doccomment">//!</span>
<span class="doccomment">//!     // This will underline/mark the specific code inside the larger</span>
<span class="doccomment">//!     // snippet context.</span>
<span class="doccomment">//!     #[label = &quot;This is the highlight&quot;]</span>
<span class="doccomment">//!     err_span: SourceSpan,</span>
<span class="doccomment">//!</span>
<span class="doccomment">//!     // You can add as many labels as you want.</span>
<span class="doccomment">//!     // They&#39;ll be rendered sequentially.</span>
<span class="doccomment">//!     #[label(&quot;This is bad&quot;)]</span>
<span class="doccomment">//!     snip2: (usize, usize), // `(usize, usize)` is `Into&lt;SourceSpan&gt;`!</span>
<span class="doccomment">//!</span>
<span class="doccomment">//!     // Snippets can be optional, by using Option:</span>
<span class="doccomment">//!     #[label(&quot;some text&quot;)]</span>
<span class="doccomment">//!     snip3: Option&lt;SourceSpan&gt;,</span>
<span class="doccomment">//!</span>
<span class="doccomment">//!     // with or without label text</span>
<span class="doccomment">//!     #[label]</span>
<span class="doccomment">//!     snip4: Option&lt;SourceSpan&gt;,</span>
<span class="doccomment">//! }</span>
<span class="doccomment">//! ```</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! #### ... help text</span>
<span class="doccomment">//! `miette` provides two facilities for supplying help text for your errors:</span>
<span class="comment">//</span>
<span class="doccomment">//! The first is the `#[help()]` format attribute that applies to structs or</span>
<span class="doccomment">//! enum variants:</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! ```rust</span>
<span class="doccomment">//! use miette::Diagnostic;</span>
<span class="doccomment">//! use thiserror::Error;</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! #[derive(Debug, Diagnostic, Error)]</span>
<span class="doccomment">//! #[error(&quot;welp&quot;)]</span>
<span class="doccomment">//! #[diagnostic(help(&quot;try doing this instead&quot;))]</span>
<span class="doccomment">//! struct Foo;</span>
<span class="doccomment">//! ```</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! The other is by programmatically supplying the help text as a field to</span>
<span class="doccomment">//! your diagnostic:</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! ```rust</span>
<span class="doccomment">//! use miette::Diagnostic;</span>
<span class="doccomment">//! use thiserror::Error;</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! #[derive(Debug, Diagnostic, Error)]</span>
<span class="doccomment">//! #[error(&quot;welp&quot;)]</span>
<span class="doccomment">//! #[diagnostic()]</span>
<span class="doccomment">//! struct Foo {</span>
<span class="doccomment">//!     #[help]</span>
<span class="doccomment">//!     advice: Option&lt;String&gt;, // Can also just be `String`</span>
<span class="doccomment">//! }</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! let err = Foo {</span>
<span class="doccomment">//!     advice: Some(&quot;try doing this instead&quot;.to_string()),</span>
<span class="doccomment">//! };</span>
<span class="doccomment">//! ```</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! ### ... multiple related errors</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! `miette` supports collecting multiple errors into a single diagnostic, and</span>
<span class="doccomment">//! printing them all together nicely.</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! To do so, use the `#[related]` tag on any `IntoIter` field in your</span>
<span class="doccomment">//! `Diagnostic` type:</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! ```rust</span>
<span class="doccomment">//! use miette::Diagnostic;</span>
<span class="doccomment">//! use thiserror::Error;</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! #[derive(Debug, Error, Diagnostic)]</span>
<span class="doccomment">//! #[error(&quot;oops&quot;)]</span>
<span class="doccomment">//! struct MyError {</span>
<span class="doccomment">//!     #[related]</span>
<span class="doccomment">//!     others: Vec&lt;MyError&gt;,</span>
<span class="doccomment">//! }</span>
<span class="doccomment">//! ```</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! ### ... delayed source code</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! Sometimes it makes sense to add source code to the error message later.</span>
<span class="doccomment">//! One option is to use [`with_source_code()`](Report::with_source_code)</span>
<span class="doccomment">//! method for that:</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! ```rust,no_run</span>
<span class="doccomment">//! use miette::{Diagnostic, SourceSpan};</span>
<span class="doccomment">//! use thiserror::Error;</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! #[derive(Diagnostic, Debug, Error)]</span>
<span class="doccomment">//! #[error(&quot;oops&quot;)]</span>
<span class="doccomment">//! #[diagnostic()]</span>
<span class="doccomment">//! pub struct MyErrorType {</span>
<span class="doccomment">//!     // Note: label but no source code</span>
<span class="doccomment">//!     #[label]</span>
<span class="doccomment">//!     err_span: SourceSpan,</span>
<span class="doccomment">//! }</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! fn do_something() -&gt; miette::Result&lt;()&gt; {</span>
<span class="doccomment">//!     // This function emits actual error with label</span>
<span class="doccomment">//!     return Err(MyErrorType {</span>
<span class="doccomment">//!         err_span: (7..11).into(),</span>
<span class="doccomment">//!     })?;</span>
<span class="doccomment">//! }</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! fn main() -&gt; miette::Result&lt;()&gt; {</span>
<span class="doccomment">//!     do_something().map_err(|error| {</span>
<span class="doccomment">//!         // And this code provides the source code for inner error</span>
<span class="doccomment">//!         error.with_source_code(String::from(&quot;source code&quot;))</span>
<span class="doccomment">//!     })</span>
<span class="doccomment">//! }</span>
<span class="doccomment">//! ```</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! Also source code can be provided by a wrapper type. This is especially</span>
<span class="doccomment">//! useful in combination with `related`, when multiple errors should be</span>
<span class="doccomment">//! emitted at the same time:</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! ```rust,no_run</span>
<span class="doccomment">//! use miette::{Diagnostic, Report, SourceSpan};</span>
<span class="doccomment">//! use thiserror::Error;</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! #[derive(Diagnostic, Debug, Error)]</span>
<span class="doccomment">//! #[error(&quot;oops&quot;)]</span>
<span class="doccomment">//! #[diagnostic()]</span>
<span class="doccomment">//! pub struct InnerError {</span>
<span class="doccomment">//!     // Note: label but no source code</span>
<span class="doccomment">//!     #[label]</span>
<span class="doccomment">//!     err_span: SourceSpan,</span>
<span class="doccomment">//! }</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! #[derive(Diagnostic, Debug, Error)]</span>
<span class="doccomment">//! #[error(&quot;oops: multiple errors&quot;)]</span>
<span class="doccomment">//! #[diagnostic()]</span>
<span class="doccomment">//! pub struct MultiError {</span>
<span class="doccomment">//!     // Note source code by no labels</span>
<span class="doccomment">//!     #[source_code]</span>
<span class="doccomment">//!     source_code: String,</span>
<span class="doccomment">//!     // The source code above is used for these errors</span>
<span class="doccomment">//!     #[related]</span>
<span class="doccomment">//!     related: Vec&lt;InnerError&gt;,</span>
<span class="doccomment">//! }</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! fn do_something() -&gt; Result&lt;(), Vec&lt;InnerError&gt;&gt; {</span>
<span class="doccomment">//!     Err(vec![</span>
<span class="doccomment">//!         InnerError {</span>
<span class="doccomment">//!             err_span: (0..6).into(),</span>
<span class="doccomment">//!         },</span>
<span class="doccomment">//!         InnerError {</span>
<span class="doccomment">//!             err_span: (7..11).into(),</span>
<span class="doccomment">//!         },</span>
<span class="doccomment">//!     ])</span>
<span class="doccomment">//! }</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! fn main() -&gt; miette::Result&lt;()&gt; {</span>
<span class="doccomment">//!     do_something().map_err(|err_list| MultiError {</span>
<span class="doccomment">//!         source_code: &quot;source code&quot;.into(),</span>
<span class="doccomment">//!         related: err_list,</span>
<span class="doccomment">//!     })?;</span>
<span class="doccomment">//!     Ok(())</span>
<span class="doccomment">//! }</span>
<span class="doccomment">//! ```</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! ### ... Diagnostic-based error sources.</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! When one uses the `#[source]` attribute on a field, that usually comes</span>
<span class="doccomment">//! from `thiserror`, and implements a method for</span>
<span class="doccomment">//! [`std::error::Error::source`]. This works in many cases, but it&#39;s lossy:</span>
<span class="doccomment">//! if the source of the diagnostic is a diagnostic itself, the source will</span>
<span class="doccomment">//! simply be treated as an `std::error::Error`.</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! While this has no effect on the existing _reporters_, since they don&#39;t use</span>
<span class="doccomment">//! that information right now, APIs who might want this information will have</span>
<span class="doccomment">//! no access to it.</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! If it&#39;s important for you for this information to be available to users,</span>
<span class="doccomment">//! you can use `#[diagnostic_source]` alongside `#[source]`. Not that you</span>
<span class="doccomment">//! will likely want to use _both_:</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! ```rust</span>
<span class="doccomment">//! use miette::Diagnostic;</span>
<span class="doccomment">//! use thiserror::Error;</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! #[derive(Debug, Diagnostic, Error)]</span>
<span class="doccomment">//! #[error(&quot;MyError&quot;)]</span>
<span class="doccomment">//! struct MyError {</span>
<span class="doccomment">//!     #[source]</span>
<span class="doccomment">//!     #[diagnostic_source]</span>
<span class="doccomment">//!     the_cause: OtherError,</span>
<span class="doccomment">//! }</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! #[derive(Debug, Diagnostic, Error)]</span>
<span class="doccomment">//! #[error(&quot;OtherError&quot;)]</span>
<span class="doccomment">//! struct OtherError;</span>
<span class="doccomment">//! ```</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! ### ... handler options</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! [`MietteHandler`] is the default handler, and is very customizable. In</span>
<span class="doccomment">//! most cases, you can simply use [`MietteHandlerOpts`] to tweak its behavior</span>
<span class="doccomment">//! instead of falling back to your own custom handler.</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! Usage is like so:</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! ```rust</span>
<span class="doccomment">//! miette::set_hook(Box::new(|_| {</span>
<span class="doccomment">//!     Box::new(</span>
<span class="doccomment">//!         miette::MietteHandlerOpts::new()</span>
<span class="doccomment">//!             .terminal_links(true)</span>
<span class="doccomment">//!             .unicode(false)</span>
<span class="doccomment">//!             .context_lines(3)</span>
<span class="doccomment">//!             .tab_width(4)</span>
<span class="doccomment">//!             .build(),</span>
<span class="doccomment">//!     )</span>
<span class="doccomment">//! }))</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! # .unwrap()</span>
<span class="doccomment">//! ```</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! See the docs for [`MietteHandlerOpts`] for more details on what you can</span>
<span class="doccomment">//! customize!</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! ## Acknowledgements</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! `miette` was not developed in a void. It owes enormous credit to various</span>
<span class="doccomment">//! other projects and their authors:</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! - [`anyhow`](http://crates.io/crates/anyhow) and</span>
<span class="doccomment">//!   [`color-eyre`](https://crates.io/crates/color-eyre): these two</span>
<span class="doccomment">//!   enormously influential error handling libraries have pushed forward the</span>
<span class="doccomment">//!   experience of application-level error handling and error reporting.</span>
<span class="doccomment">//!   `miette`&#39;s `Report` type is an attempt at a very very rough version of</span>
<span class="doccomment">//!   their `Report` types.</span>
<span class="doccomment">//! - [`thiserror`](https://crates.io/crates/thiserror) for setting the</span>
<span class="doccomment">//!   standard for library-level error definitions, and for being the</span>
<span class="doccomment">//!   inspiration behind `miette`&#39;s derive macro.</span>
<span class="doccomment">//! - `rustc` and [@estebank](https://github.com/estebank) for their</span>
<span class="doccomment">//!   state-of-the-art work in compiler diagnostics.</span>
<span class="doccomment">//! - [`ariadne`](https://crates.io/crates/ariadne) for pushing forward how</span>
<span class="doccomment">//!   _pretty_ these diagnostics can really look!</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! ## License</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! `miette` is released to the Rust community under the [Apache license</span>
<span class="doccomment">//! 2.0](./LICENSE).</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! It also includes code taken from [`eyre`](https://github.com/yaahc/eyre),</span>
<span class="doccomment">//! and some from [`thiserror`](https://github.com/dtolnay/thiserror), also</span>
<span class="doccomment">//! under the Apache License. Some code is taken from</span>
<span class="doccomment">//! [`ariadne`](https://github.com/zesterer/ariadne), which is MIT licensed.</span>
<span class="kw">pub</span> <span class="kw">use</span> <span class="ident">miette_derive</span>::<span class="kw-2">*</span>;

<span class="kw">pub</span> <span class="kw">use</span> <span class="ident">error</span>::<span class="kw-2">*</span>;
<span class="kw">pub</span> <span class="kw">use</span> <span class="ident">eyreish</span>::<span class="kw-2">*</span>;
<span class="attribute">#[<span class="ident">cfg</span>(<span class="ident">feature</span> <span class="op">=</span> <span class="string">&quot;fancy-no-backtrace&quot;</span>)]</span>
<span class="kw">pub</span> <span class="kw">use</span> <span class="ident">handler</span>::<span class="kw-2">*</span>;
<span class="kw">pub</span> <span class="kw">use</span> <span class="ident">handlers</span>::<span class="kw-2">*</span>;
<span class="kw">pub</span> <span class="kw">use</span> <span class="ident">named_source</span>::<span class="kw-2">*</span>;
<span class="attribute">#[<span class="ident">cfg</span>(<span class="ident">feature</span> <span class="op">=</span> <span class="string">&quot;fancy&quot;</span>)]</span>
<span class="kw">pub</span> <span class="kw">use</span> <span class="ident">panic</span>::<span class="kw-2">*</span>;
<span class="kw">pub</span> <span class="kw">use</span> <span class="ident">protocol</span>::<span class="kw-2">*</span>;

<span class="kw">mod</span> <span class="ident">chain</span>;
<span class="kw">mod</span> <span class="ident">diagnostic_chain</span>;
<span class="kw">mod</span> <span class="ident">error</span>;
<span class="kw">mod</span> <span class="ident">eyreish</span>;
<span class="attribute">#[<span class="ident">cfg</span>(<span class="ident">feature</span> <span class="op">=</span> <span class="string">&quot;fancy-no-backtrace&quot;</span>)]</span>
<span class="kw">mod</span> <span class="ident">handler</span>;
<span class="kw">mod</span> <span class="ident">handlers</span>;
<span class="attribute">#[<span class="ident">doc</span>(<span class="ident">hidden</span>)]</span>
<span class="kw">pub</span> <span class="kw">mod</span> <span class="ident">macro_helpers</span>;
<span class="kw">mod</span> <span class="ident">named_source</span>;
<span class="attribute">#[<span class="ident">cfg</span>(<span class="ident">feature</span> <span class="op">=</span> <span class="string">&quot;fancy&quot;</span>)]</span>
<span class="kw">mod</span> <span class="ident">panic</span>;
<span class="kw">mod</span> <span class="ident">protocol</span>;
<span class="kw">mod</span> <span class="ident">source_impls</span>;
</code></pre></div>
</section></div></main><div id="rustdoc-vars" data-root-path="../../" data-current-crate="miette" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.63.0 (4b91a6ea7 2022-08-08)" ></div>
</body></html>